--- original/login.php	2025-11-19 17:15:33.001507319 -0500
+++ artifacts/exploits/vul3/login.php	2025-11-21 17:41:55.602512378 -0500
@@ -1,4 +1,4 @@
-<?php require 'utils.php'; require 'db.php'; $error=null; if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $sql="SELECT * FROM users WHERE username = '{$_POST['username']}' AND password = '{$_POST['password']}' LIMIT 1;"; $row=$db->query($sql)->fetch(PDO::FETCH_ASSOC); if($row){ $_SESSION['user']=$row; header('Location:index.php'); exit; } else { $error='Invalid credentials'; }} site_header('Login'); ?>
+<?php require 'utils.php'; require 'db.php'; $error=null; if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $sql="SELECT * FROM users WHERE username = '{$_POST['username']}' LIMIT 1;"; $row=$db->query($sql)->fetch(PDO::FETCH_ASSOC); if($row and password_verify($_POST['password'], $row['password'])){  $_SESSION['user']=$row; header('Location:index.php'); exit; } else { $error='Invalid credentials'; }} site_header('Login'); ?>
 
 <section class="page-header">
   <h1 class="page-title">Welcome back</h1>
--- original/register.php	2025-11-19 17:15:33.137507252 -0500
+++ artifacts/exploits/vul3/register.php	2025-11-21 17:30:57.774827971 -0500
@@ -1,4 +1,4 @@
-<?php require 'utils.php'; require 'db.php'; site_header('Register'); if($_SERVER['REQUEST_METHOD']==='POST'){ $db=get_db(); $sql="INSERT INTO users(username,password) VALUES ('{$_POST['username']}', '{$_POST['password']}')"; try { $db->exec($sql); echo "<section class='card'><h2>Account ready</h2><p class='muted'>You can sign in right away.</p><div class='form-actions'><a class='btn primary' href='login.php'>Proceed to login</a></div></section>"; site_footer(); exit; } catch(Exception $e){ echo "<section class='card'><div class='alert'>Error: ".htmlspecialchars($e->getMessage())."</div></section>"; site_footer(); exit; }} ?>
+<?php require 'utils.php'; require 'db.php'; site_header('Register'); $error = ""; if($_SERVER['REQUEST_METHOD']==='POST'){ if(preg_match('/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).+$/', $_POST['password']) and strlen($_POST['password']) >= 6) { $db=get_db(); $sql="INSERT INTO users(username,password) VALUES ('{$_POST['username']}', '{password_hash($_POST['password'], PASSWORD_BCRYPT)}')"; try { $db->exec($sql); echo "<section class='card'><h2>Account ready</h2><p class='muted'>You can sign in right away.</p><div class='form-actions'><a class='btn primary' href='login.php'>Proceed to login</a></div></section>"; site_footer(); exit; } catch(Exception $e){ echo "<section class='card'><div class='alert'>Error: ".htmlspecialchars($e->getMessage())."</div></section>"; site_footer(); exit; }} else { $error="Error: Your password does not meet the given criteria."; }} ?>
 
 <section class="page-header">
   <h1 class="page-title">Join the Console</h1>
@@ -10,6 +10,9 @@
     <h2>Create Account</h2>
     <span class="pill">Module 06</span>
   </div>
+  <?php if ($error): ?>
+    <div class="alert"><?= $error ?></div>
+  <?php endif; ?>
   <form method="POST" class="form-stack">
     <label class="input-group">
       <span>Username</span>
@@ -19,6 +22,14 @@
       <span>Password</span>
       <input name="password" type="password" autocomplete="new-password">
     </label>
+    <div class="pw-criteria">Passwords must meet the following criteria:
+      <ul>
+        <li>At least six (6) characters.</li>
+        <li>At least one (1) upper-case letter.</li>
+        <li>At least one (1) lower-case letter.</li>
+        <li>At least one (1) number.</li>
+      </ul>
+    </div>
     <div class="form-actions">
       <button type="submit" class="primary">Register</button>
       <a class="btn link" href="login.php">Back to login</a>
