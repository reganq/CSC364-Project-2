--- original/user.php	2025-11-21 21:13:33.733036852 -0500
+++ artifacts/exploits/vul5/user.php	2025-11-21 21:10:46.377116557 -0500
@@ -1,4 +1,4 @@
-<?php require 'utils.php'; require 'db.php'; $id=$_GET['id']??'1'; $db=get_db(); $row=$db->query("SELECT * FROM users WHERE id = $id")->fetch(PDO::FETCH_ASSOC); if(!$row){ site_header('User Profile'); echo "<section class='card'><div class='alert'>No such user</div><div class='form-actions'><a class='btn link' href='index.php'>Return to feed</a></div></section>"; site_footer(); exit; } site_header('User Profile'); ?>
+<?php require 'utils.php'; require 'db.php'; $id=$_GET['id']??'1'; $signedIn=($id == $_SESSION['user']['id']); $db=get_db(); $row=$db->query("SELECT * FROM users WHERE id = $id")->fetch(PDO::FETCH_ASSOC); if(!$row){ site_header('User Profile'); echo "<section class='card'><div class='alert'>No such user</div><div class='form-actions'><a class='btn link' href='index.php'>Return to feed</a></div></section>"; site_footer(); exit; } site_header('User Profile'); ?>
 
 <section class="page-header">
   <h1 class="page-title">Crew Member</h1>
@@ -13,7 +13,9 @@
   <div class="stack">
     <p><strong>ID:</strong> <?= $row['id'] ?></p>
     <p><strong>Username:</strong> <?= $row['username'] ?></p>
-    <p><strong>Password:</strong> <?= $row['password'] ?></p>
+    <?php if ($signedIn): ?>
+      <p><strong>Password Hash:</strong> <?= $row['password'] ?></p>
+    <?php endif; ?>
   </div>
   <div class="form-actions">
     <a class="btn link" href="index.php">Back to feed</a>
