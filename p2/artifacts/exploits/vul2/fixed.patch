--- original/ping.php	2025-11-19 17:15:33.069507285 -0500
+++ artifacts/exploits/vul2/ping.php	2025-11-19 19:33:58.724206422 -0500
@@ -6,12 +6,8 @@
 if ($_SERVER['REQUEST_METHOD'] === 'POST') {
     $host = $_POST['host'] ?? '';
 
-    // Block dangerous shell characters
-    if (preg_match('/[&|><`$!]/', $host)) {
-        $output = "Invalid characters detected.";
-    } else {
-        $output = shell_exec("ping -c 1 $host 2>&1");
-    }
+    // Escape any dangerous shell characters
+    $output = shell_exec('ping -c 1 ' . escapeshellarg($host) . ' 2>&1');
 }
 ?>
 <section class="page-header">
